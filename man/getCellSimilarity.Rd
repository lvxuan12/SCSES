% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/getSimilarity.R
\name{getCellSimilarity}
\alias{getCellSimilarity}
\title{Construct KNN Graph for Single Cells}
\usage{
getCellSimilarity(
  paras,
  rds_path = NULL,
  output_path = NULL,
  feature_num = paras$Task$impute$feature_num,
  rbp = paras$Task$impute$rbp,
  cell_similarity_data = paras$Task$impute$cell_similarity_data,
  distance_method = paras$Task$impute$KNN$cell$distance_method,
  alpha_cell = paras$Task$impute$KNN$cell$alpha,
  decay_cell = paras$Task$impute$KNN$cell$decay,
  kcell_max = paras$Task$impute$KNN$cell$kmax,
  kcell_min = paras$Task$impute$KNN$cell$kmin,
  cell.select = NULL
)
}
\arguments{
\item{paras}{A list object containing SCSES configuration parameters, typically
loaded using \code{readSCSESconfig(paras_file)}.}

\item{rds_path}{Character string specifying the path to processed RDS data files.
This directory should contain the preprocessed single-cell data matrices
(expr.rds, rc.rds, psi.rds) generated by upstream processing functions.
Default: extracted from \code{paras$Basic$work_path/rds_processed/}.}

\item{output_path}{Character string specifying the output directory for cell
similarity results. Default: \code{work_path/imputation/cell_similarity/}.}

\item{feature_num}{Integer specifying the number of highly variable features
to select. Default: 1000 (extracted from \code{paras$Task$impute$feature_num}).}

\item{rbp}{Character string or file path specifying RNA-binding protein (RBP)
information. Can be either:
\itemize{
  \item File path to RBP annotation file
  \item Character string containing RBP gene symbols
  \item \code{NULL} to use default RBP set from configuration
}
Default: \code{paras$Task$impute$rbp}.}

\item{cell_similarity_data}{Character string specifying features for
cell similarity calculation, separated by semicolons.Valid options include:
\itemize{
  \item \code{"EXP_RBP"}: TPM/normalized UMI counts for RNA-binding proteins
    (source: rds_processed/expr.rds)
  \item \code{"RC"}: Raw junction read counts for splicing events
    (source: rds_processed/rc.rds)
  \item \code{"PSI"}: PSI values for splicing events
    (source: rds_processed/psi.rds)
}
Example: \code{"EXP_RBP;RC;PSI"}}

\item{distance_method}{Character string specifying the distance metric for
cell-to-cell similarity calculation. Supported methods:
\itemize{
  \item \code{"euclidean"}
  \item \code{"cosine"}
}
Default: \code{"euclidean"}.}

\item{alpha_cell}{Numeric value between 0 and 1 specifying the random walk
probability (1-restart probability).
Default: 0.8 (from \code{paras$Task$impute$KNN$cell$alpha}).}

\item{decay_cell}{Numeric threshold of change in the similarity matrix.
The algorithm stops when the change falls below this threshold between
consecutive iterations. Default: 0.05 (from \code{paras$Task$impute$KNN$cell$decay}).}

\item{kcell_max}{Integer specifying the maximum number of nearest neighbors
to consider for each cell.
Default: 50 (from \code{paras$Task$impute$KNN$cell$kmax}).}

\item{kcell_min}{Integer specifying the minimum number of nearest neighbors
to maintain for each cell.
Default: 5 (from \code{paras$Task$impute$KNN$cell$kmin}).}

\item{cell.select}{Character vector specifying cell identifiers to include
in the analysis. Cell names should match the single-cell BAM file names
excluding the .bam suffix. If \code{NULL}, all available cells are processed.
Default: \code{NULL} (process all cells).}
}
\value{
Character string specifying the path to the cell similarity output
  directory (\code{work_path/imputation/cell_similarity/}). The function saves
  two main output files:
  \itemize{
    \item \code{cell.similars.rds}: List containing similarity matrices for
      different features
    \item \code{dyk.cell.rds}: List containing the number of neighbors
      determined for each cell
  }
}
\description{
This function constructs k-nearest neighbor (KNN) graphs for single cells
  based on multiple data modalities including RNA-binding protein (RBP) expression,
  raw junction read counts, and PSI values. It computes cell-to-cell distances
  using specified distance metrics and applies random walk-based similarity refinement
  to capture higher-order relationships in the cellular neighborhood structure.
  The resulting similarity matrices are used for downstream imputation.
}
